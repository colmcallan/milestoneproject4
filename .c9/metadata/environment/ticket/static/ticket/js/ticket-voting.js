{"filter":false,"title":"ticket-voting.js","tooltip":"/ticket/static/ticket/js/ticket-voting.js","undoManager":{"mark":1,"position":1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":46,"column":1},"action":"insert","lines":["","/*","=========================================================","   VOTING ON BUGS ONLY","=========================================================","*/","","","if (document.querySelector('#ticket-vote-free')) {","    const votesCount = document.querySelector('#votes-count');","    const voteFree = document.querySelector('#ticket-vote-free');","","    // on click get the tickets id and post to backend","    voteFree.onclick = (event) => {","        event.preventDefault();","        const _id = event.target.dataset.id;","","        fetch(`/tickets/api/${_id}/vote/`, {","            headers: new Headers({","                'Content-Type': 'application/x-www-form-urlencoded',","                'X-CSRFToken': csrftoken,","                'X-Requested-With': 'XMLHttpRequest',","            }),","            credentials: 'same-origin',","            method: 'PUT',","            body: `votes=1&id=${_id}`","        })","        .then(res => {","            if (res.status === 200) {","                return res.json()","            }","        })","        .then(data => {","","            // if response if ok, make sure user cannot vote again","            // increase the vote number of the ticket","            if (data.text === 'ok') {","                voteFree.setAttribute('disabled', 'true');","                voteFree.classList.add('gey');","                voteFree.classList.remove('primary');","                voteFree.innerText = 'You have already voted for this';","                votesCount.innerText = data.votes.toString()","            }","        })","        .catch(err => console.log(err))","    }","}"],"id":1}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""],"id":2}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1566250459916,"hash":"4d1edd179a8f743c891c2c69c22785a5713ecfa6"}